---
title: "Download data"
author: "Max Czapanskiy"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(purrr)
library(sbtools)
library(stringr)
```

## Data sources

This analysis relies on two data sources: tracking data collected by USGS and wind vectors from the Pacific Islands Ocean Observing System (PacIOOS) regional atmospheric model. These data are too large to store in the analysis repository, so this document walks the reader through the download process.

## Tracking data

The Red-footed Booby (RFBO) tracking data is archived in USGS' ScienceBase as part of a larger data release (DOI 10.5066/P9NTEXM6). Follow these steps to download the data:

1. Direct your browser to [DOI 10.5066/P9NTEXM6](http://doi.org/10.5066/P9NTEXM6).
2. Navigate to the second child item entitled "2. GPS (e-obs) Tracking and Accelerometry Data of Seabirds Breeding in the Main Hawaiian Islands".
3. Under "Attached Files", follow the link to "RFBO_eObs.zip" and download the file.
4. Unzip "RFBO_eObs.zip" and move "RFBO_eObs_clean.csv" to "analysis/data/raw_data" in this project. *NOTE:* the default archive utility on MacOS doesn't handle files this size appropriately and throws "Error 79 - Inappropriate file type or format." I suggest installing [The Unarchiver](https://theunarchiver.com/) and using that to unzip the file.

The following checks data integrity. First, it verifies the existence of "RFBO_eObs_clean.csv" in the correct location. Then, it checks whether the contents of the file match the original data. If you encounter an error, try deleting "RFBO_eObs.zip" and "RFBO_eObs_clean.csv", then repeat steps 1-4 above.

```{r tracking_data}
rfbo_filepath <- here::here("analysis", "data", "raw_data", "RFBO_eObs_clean.csv")
rfbo_checksum <- readLines(here::here("analysis", "data", "raw_data", "RFBO_checksum")) 
if (!file.exists(rfbo_filepath)) {
  cat(sprintf("\"RFBO_eObs_clean.csv\" not found. It should be in:\n  %s",
              dirname(rfbo_filepath)))
} else if (tools::md5sum(rfbo_filepath) != rfbo_checksum) {
  cat("You have a copy of \"RFBO_eObs_clean.csv\", but it doesn't match the original.")
} else {
  cat("You have the correct tracking data!")
}
```

## Wind data
